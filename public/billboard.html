<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billboard Hot 100</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .song { margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Billboard Hot 100 - Top 10</h1>
    <div id="chart">Loading...</div>
    <div id="status"></div>

    <script>
        const API_KEY = '13526bb673msh005f132a34f304cp1bd530jsn5e4e1e7411db';
        
        async function fetchBillboardChart() {
            try {
                const now = new Date();
                const dateStr = now.toISOString().split('T')[0];
                
                const url = `https://billboard-api2.p.rapidapi.com/hot-100?date=${dateStr}&range=1-10`;
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'x-rapidapi-key': API_KEY,
                        'x-rapidapi-host': 'billboard-api2.p.rapidapi.com'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('Error:', error);
                throw error;
            }
        }
        
        function displayChart(data) {
            const chartDiv = document.getElementById('chart');
            const statusDiv = document.getElementById('status');
            
            let songs = [];
            
            if (data.content) {
                songs = typeof data.content === 'object' && !Array.isArray(data.content) 
                    ? Object.values(data.content) 
                    : data.content;
            } else if (data.chart) {
                songs = data.chart;
            } else if (data.entries) {
                songs = data.entries;
            } else if (Array.isArray(data)) {
                songs = data;
            }
            
            if (!songs || songs.length === 0) {
                chartDiv.innerHTML = 'No chart data available';
                return;
            }
            
            let html = '';
            songs.slice(0, 10).forEach(song => {
                const rank = song.rank || song.position || '?';
                const title = song.title || song.song || 'Unknown';
                const artist = song.artist || song.artists || 'Unknown Artist';
                
                html += `<div class="song">${rank}. ${title} - ${artist}</div>`;
            });
            
            chartDiv.innerHTML = html;
            
            const chartDate = data.info?.date || data.date || data.week || data.chartDate;
            const now = new Date().toISOString();
            statusDiv.textContent = chartDate ? `Chart: ${chartDate} | Fetched: ${now}` : `Fetched: ${now}`;
        }
        
        async function init() {
            try {
                const data = await fetchBillboardChart();
                displayChart(data);
            } catch (error) {
                document.getElementById('chart').textContent = `Error: ${error.message}`;
            }
        }
        
        init();
        setInterval(init, 3600000);
    </script>
</body>
</html>
